
import os
import pandas as pd

def MDScalc(MDS1):

    with open(MDS1) as F:

        tf = list()
        motifs = list()
        hsum = list()
        Hsum = list()

        for line in F:
            if 'HO_' in line:
                tf.append(line.split(',')[0])
                motifs.append(line.split(',')[1:3000])
        for motif in motifs:
            Hsum.append(sum(int(i) for i in motif))
            hsum.append(sum(int(i) for i in motif[149:299]))
        
        mds = [float(x)/float(y) if x > 0 and y > 0 else 0 for x,y in zip(hsum, Hsum)] 

        MDSzip = zip(tf, hsum, Hsum, mds)
        MDS = pd.DataFrame(MDSzip,columns=['TF_motif','h_hits','H_hits','MDS'])
        print MDS

if __name__ == "__main__":
    homedir = os.path.dirname(os.path.realpath(__file__))                          
    MDSdir = '/scratch/Shares/dowell/md_score_paper/mdscore_tsv_files/human/recent/'#'/scratch/Users/rusi2317/projects/rotation/input/'
    MDS1 = MDSdir + 'SRR1105737_MDS.csv'
    ##MDS1 = MDSdir + 'test_MDS.csv'
    savedir = ''
    MDScalc(MDS1)


